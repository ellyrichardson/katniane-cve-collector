package com.katniane.katnianecvecollector.domain;

import java.util.List;

import org.springframework.data.annotation.Id;
import org.springframework.data.mongodb.core.mapping.Document;

import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;

@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
@Builder
@Document("cve")
public class Cve {
	
	@Id
	private String id;
	
	private String sourceIdentifier;
	
	private String published;
	
	private String lastModified;
	
	private String vulnStatus;
	
	private String cisaExploitAdd;
	
	private String cisaActionDue;
	
	private String cisaRequiredAction;
	
	private String cisaVulnerabilityName;
	
	private List<CveDescription> descriptions;
	
	private List<CveMetrics> metrics;
	
	private List<CveWeakness> weaknesses;
	
	private List<CveConfiguration> configurations;
	
	private List<CveReference> references;
	
	@Getter
	@Setter
	@NoArgsConstructor
	// Under Cve
	public class CveDescription {
		private String lang;
		
		private String value;
	}
	
	@Getter
	@Setter
	@NoArgsConstructor
	// Under Cve
	public class CveWeakness {
		private String source;
		
		private String type;
		
		private List<CveDescription> description;
	}
	
	@Getter
	@Setter
	@NoArgsConstructor
	// Under CveWeakness
	// TODO: Probably can remove if same as CveDescription
	public class CveWeaknessDescription {
		private String lang;
		
		private String value;
	}
	
	@Getter
	@Setter
	@AllArgsConstructor
	// Under Cve
	public class CveConfiguration {
		private List<CveConfigurationNode> nodes;
	}
	
	@Getter
	@Setter
	@NoArgsConstructor
	// Under CveConfiguration
	public class CveConfigurationNode {
		private String operator;
		
		private boolean negate;
		
		private List<CveConfigurationNodeCpeMatch> cpeMatch;
	}
	
	@Getter
	@Setter
	@NoArgsConstructor
	// Under CveConfigurationNode
	public class CveConfigurationNodeCpeMatch {
		private boolean vulnerable;
		
		private String criteria;
		
		private String matchCriteriaId;
	}
	
	@Getter
	@Setter
	@NoArgsConstructor
	// Under Cve
	public class CveReference {
		private String url;
		
		private String source;
		
		private List<String> tags;
	}
	
	@Getter
	@Setter
	@NoArgsConstructor
	// Under Cve
	public class CveMetrics {
		private CvssMetricsV2 cvssMetrics;
		
		private String baseSeverity;
		
		private double exploitabilityScore;
		
		private double impactScore;
		
		private boolean acInsufInfo;
		
		private boolean obtainAllPrivelege;
		
		private boolean obtainUserPrivelege;
		
		private boolean obtainOtherPrivelege;
		
		private boolean userInteractionRequired;
	}
	
	@Getter
	@Setter
	@NoArgsConstructor
	// Under CveMetrics
	public class CvssMetricsV2 {
		private String source = "";
		
		private String type = "";
	}
		
	@Getter
	@Setter
	@NoArgsConstructor
	// Under CveMetrics
	public class CvssData {
		private String version;
		
		private String vectorString;
		
		private String accessVector;
		
		private String accessComplexity;
		
		private String authenticity;
		
		private String confidentialityImpact;
		
		private String integrityImpact;
		
		private String availabilityImpact;
		
		private double baseScore;
	}
}
